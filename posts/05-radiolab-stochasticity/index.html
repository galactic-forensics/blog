<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Seven in a row
        
    </title><meta content="Seven in a row" property=og:title><meta content="Thoughts and ideas..." property=og:description><meta content="Thoughts and ideas..." name=description><link href=https://galactic-forensics.github.io/blog/fonts.css rel=stylesheet><script src=https://galactic-forensics.github.io/blog/js/codeblock.js></script><script src=https://galactic-forensics.github.io/blog/js/toc.js></script><script src=https://galactic-forensics.github.io/blog/js/note.js></script><script>MathJax={tex:{inlineMath:[[`\$`,`\$`],[`\\\\(`,`\\\\)`]]}}</script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link title="Galactic Forensics" href=https://galactic-forensics.github.io/blog/atom.xml rel=alternate type=application/atom+xml><link href=https://galactic-forensics.github.io/blog/theme/light.css rel=stylesheet><link href=https://galactic-forensics.github.io/blog/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://galactic-forensics.github.io/blog/js/themetoggle.js></script><script>setTheme(getSavedTheme())</script><link href=https://galactic-forensics.github.io/blog/main.css media=screen rel=stylesheet><link href=https://galactic-forensics.github.io/blog/override.css rel=stylesheet><body><div class=content><header><div class=main><a href=https://galactic-forensics.github.io/blog>Galactic Forensics</a><div class=socials><a class=social href=https://github.com/galactic-forensics/ rel=me> <img alt=github src=https://galactic-forensics.github.io/blog/social_icons/github.svg> </a></div></div><nav><a href=https://galactic-forensics.github.io/blog/posts style=margin-left:.5em>/posts</a><a href=https://galactic-forensics.github.io/blog/tags style=margin-left:.5em>/tags</a> |<a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://galactic-forensics.github.io/blog/feather/sun.svg style=filter:invert()> <img alt=Dark id=moon-icon src=https://galactic-forensics.github.io/blog/feather/moon.svg> </a><script>updateItemToggleTheme()</script></nav></header><main><article><div class=title><div class=page-header>Seven in a row<span class=primary-color style=font-size:1.6em>.</span></div><div class=meta>Posted on <time>2024-03-01</time><span class=tags-label> :: Tags:</span><span class=tags> <a class=post-tag href=https://galactic-forensics.github.io/blog/tags/python/>python</a>, <a class=post-tag href=https://galactic-forensics.github.io/blog/tags/science/>science</a> </span></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://galactic-forensics.github.io/blog/posts/05-radiolab-stochasticity/#randomness>Randomness</a><li><a href=https://galactic-forensics.github.io/blog/posts/05-radiolab-stochasticity/#the-problem>The problem</a><li><a href=https://galactic-forensics.github.io/blog/posts/05-radiolab-stochasticity/#let-s-do-the-math>Let's do the math</a><li><a href=https://galactic-forensics.github.io/blog/posts/05-radiolab-stochasticity/#flipping-coins-in-python>Flipping coins in python</a><li><a href=https://galactic-forensics.github.io/blog/posts/05-radiolab-stochasticity/#comparison-of-the-results>Comparison of the results</a></ul></div><section class=body><p>One of my favorite radio shows is <a href=https://radiolab.org/>Radiolab</a>, which always presents the listener with an interesting scientific question from across the board. In a recent rerun, Radiolab discussed <a href=https://radiolab.org/podcast/91684-stochasticity/transcript>Stochasticity</a>. Something struck me as odd...</p><span id=continue-reading></span><p>I decided to do some math and figure out what was going on. And of course, what is simply math without thinking about how to also do this in python!<h1 id=randomness><a aria-label="Anchor link for: randomness" class=zola-anchor href=#randomness>Randomness</a></h1><p>In the episode, they present an experiment of flipping a coin one hundred times and recording the outcome on a board. One group actually flips the coin and writes the actual results down, the other group makes up the results and writes down those results. Afterwards, the examiner walks in to evaluate the results and immediately points out which one is the true random sequence. The way she discovered it is by looking at the longest streaks. The true random group had a much longer streak - a seven in a row - than the group that made the results up.<p>The probability to get seven tails in a row can be calculated as<p>$$p = 0.5^{7} = 0.78%,$$<p>which is very low. However, remember that they flipped one hundred times. This - according to the episode - will increase the chance of getting seven in row to about one in six.<h1 id=the-problem><a aria-label="Anchor link for: the-problem" class=zola-anchor href=#the-problem>The problem</a></h1><p>My issue with the episode was the following dialog (transcript taken directly from <a href=https://radiolab.org/podcast/91684-stochasticity/transcript>here</a>:<blockquote><p>JAD: And then Jay explained it to us: if you're just doing seven flips then yeah, getting seven in a row is really unlikely. But if you're doing multiple sets of seven ...<p>JAY KOEHLER: Fourteen of those sets of seven.<p>JAD: ... which we were, because we were doing a hundred. Then the probabilities start to add up. And we start small, like one percent. But then that one becomes two, which becomes four, which becomes eight until, when it's all said and done, the chances of getting seven tails in a row somewhere in a set of a hundred isâ€”don't hold your breath.</blockquote><p>This statement didn't make much sense to me, since any seven in a row in the series of 100 flips would work and not just one of the fourteen!<h1 id=let-s-do-the-math><a aria-label="Anchor link for: let-s-do-the-math" class=zola-anchor href=#let-s-do-the-math>Let's do the math</a></h1><p>To calculate the probability of getting seven in a row out of one hundred flips, let's first define what this even means: In order to have exactly seven in a row, the flip before and after (if we are somewhere in between flip one and flip 100) must be of the opposite side. This means that to have seven tails, the flip before and after must be heads. Therefore, we need to get in fact nine in a row correct! The probability that the first or last seven flips are of the same suit requires the flip after or before that row to be different, thus for these edge cases we only need to get eight in a row correct.<p>As so often with probability calculations, let us turn the problem around and ask the question of what is the probability that the two edge cases are not seven in a row. We can calculate the edge cases as following:<p>$$p_\mathrm{edge} = 1-0.5^8$$<p>For one hundred flips, to not get seven in a row at the beginning and the end, i.e., for the two edge cases, the probability then becomes:<p>$$p_\mathrm{edges} = (p_\mathrm{edge})^2 = (1-0.5^8)^2$$<p>For every case in between - remember we need nine in a row correct - the probability to not have seven in a row can be calculated as:<p>$$p_\mathrm{inside} = 1-0.5^9$$<p>In a series of 100, we have a total of 92 times seven flips in a row that could fit the bill, i.e., flips 2 through 8 (with 1 and 9 being of a different face), flips 3 through 9 (with 2 and 10 being of a different face), ... This gets us to a probability of not having seven in a row of the same face for the in-between cases as:<p>$$p_\mathrm{inside-cases} = (1-0.5^9)^{92}$$<p>Now that we have all cases covered, we can determine the total probability of not having seven in a row as<p>$$p_\mathrm{not} = p_\mathrm{edges} \cdot p_\mathrm{inside-cases} = (1-0.5^8)^2 \cdot (1-0.5^9)^{92}$$<p>Finally, we can turn this around again and determine the probability that we get at least one time seven in a row in one hundred flips as<p>$$p_\mathrm{result} = 1 - p_\mathrm{not} = 17.11%.$$<p>This is pretty close to the answer on the show of one in six, which would be around 16.67%.<h1 id=flipping-coins-in-python><a aria-label="Anchor link for: flipping-coins-in-python" class=zola-anchor href=#flipping-coins-in-python>Flipping coins in python</a></h1><p>Let's do a simulation of this experiment in python. We are going to simulate <code>nmc</code> times <code>nflips</code> coin flips in a row and count how many times we get at least one seven in a row. Dividing the total count by <code>nmc</code> should then give us the same result as we have determined in the calculation above.<pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#ff79c6>from </span><span>numba </span><span style=color:#ff79c6>import </span><span>njit
</span><span style=color:#ff79c6>import </span><span>numpy </span><span style=color:#ff79c6>as </span><span>np
</span><span>
</span><span>@njit
</span><span style=color:#ff79c6;font-style:italic>def </span><span style=color:#50fa7b>check_flips</span><span>(</span><span style=color:#ffb86c;font-style:italic>all_flips</span><span>: np</span><span style=color:#ff79c6>.</span><span>ndarray) -> np</span><span style=color:#ff79c6>.</span><span>ndarray:
</span><span>    </span><span style=color:#6272a4>"""Count how many times we get seven in a row.
</span><span style=color:#6272a4>    
</span><span style=color:#6272a4>    The routine is decorated with the `@njit` decorator, which we
</span><span style=color:#6272a4>    import from `numba`. This does a just-in-time compilation 
</span><span style=color:#6272a4>    of the function in order to speed things up.
</span><span style=color:#6272a4>    Feel free to remove the decorator and see the difference!
</span><span style=color:#6272a4>
</span><span style=color:#6272a4>    The routine is provided an array of all flips with `nmc`
</span><span style=color:#6272a4>    rows and `nflips` columns.
</span><span style=color:#6272a4>
</span><span style=color:#6272a4>    :param all_flips: An array of all flips, either 0 or 1.
</span><span style=color:#6272a4>        Dimension: `nmc` times `nflips`
</span><span style=color:#6272a4>
</span><span style=color:#6272a4>    :return: An array of length `nmc` stating how many times
</span><span style=color:#6272a4>        seven in a row occured in this set of `nflips`.
</span><span style=color:#6272a4>    """
</span><span>    results </span><span style=color:#ff79c6>= </span><span>np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>zeros</span><span>(all_flips</span><span style=color:#ff79c6>.</span><span>shape[</span><span style=color:#bd93f9>0</span><span>])
</span><span>
</span><span>    </span><span style=color:#ff79c6>for </span><span>it, series </span><span style=color:#ff79c6>in </span><span style=color:#8be9fd>enumerate</span><span>(all_flips):
</span><span>        </span><span style=color:#6272a4># check first 7
</span><span>        </span><span style=color:#ff79c6>if </span><span>np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>sum</span><span>(series[:</span><span style=color:#bd93f9>7</span><span>]) </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>7 </span><span style=color:#ff79c6>and </span><span>series[</span><span style=color:#bd93f9>7</span><span>] </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>0</span><span>:
</span><span>            results[it] </span><span style=color:#ff79c6>+= </span><span style=color:#bd93f9>1
</span><span>
</span><span>        </span><span style=color:#6272a4># check last 7
</span><span>        </span><span style=color:#ff79c6>if </span><span>np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>sum</span><span>(series[</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>7</span><span>:]) </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>7 </span><span style=color:#ff79c6>and </span><span>series [</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>8</span><span>] </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>0</span><span>:
</span><span>            results[it] </span><span style=color:#ff79c6>+= </span><span style=color:#bd93f9>1
</span><span>
</span><span>        </span><span style=color:#6272a4># check all in between
</span><span>        </span><span style=color:#ff79c6>for </span><span>jt </span><span style=color:#ff79c6>in </span><span style=color:#8be9fd>range</span><span>(</span><span style=color:#bd93f9>1</span><span>, nflips </span><span style=color:#ff79c6>- </span><span style=color:#bd93f9>1 </span><span style=color:#ff79c6>- </span><span style=color:#bd93f9>7</span><span>):
</span><span>            </span><span style=color:#ff79c6>if </span><span>np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>sum</span><span>(series[jt:jt</span><span style=color:#ff79c6>+</span><span style=color:#bd93f9>7</span><span>]) </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>7</span><span>:  </span><span style=color:#6272a4># row is 7
</span><span>                </span><span style=color:#6272a4># check that bounds are not 1
</span><span>                </span><span style=color:#ff79c6>if </span><span>series[jt</span><span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span><span>] </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>0 </span><span style=color:#ff79c6>and </span><span>series[jt</span><span style=color:#ff79c6>+</span><span style=color:#bd93f9>7</span><span>] </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>0</span><span>:
</span><span>                    results[it] </span><span style=color:#ff79c6>+= </span><span style=color:#bd93f9>1
</span><span>
</span><span>    </span><span style=color:#ff79c6>return </span><span>results
</span></code></pre><pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#6272a4># some starting values
</span><span>nmc </span><span style=color:#ff79c6>= </span><span style=color:#bd93f9>10_000_000
</span><span>nflips </span><span style=color:#ff79c6>= </span><span style=color:#bd93f9>100
</span></code></pre><pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#6272a4># let's generate all the flips using numpy's random.randint routine
</span><span>all_flips </span><span style=color:#ff79c6>= </span><span>np</span><span style=color:#ff79c6>.</span><span>random</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>randint</span><span>(</span><span style=color:#bd93f9>0</span><span>, </span><span style=color:#bd93f9>2</span><span>, </span><span style=color:#ffb86c;font-style:italic>size</span><span style=color:#ff79c6>=</span><span>(nmc, nflips))
</span></code></pre><pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#6272a4># get the result from our routine that we defined above
</span><span>seven_in_a_row </span><span style=color:#ff79c6>= </span><span style=color:#50fa7b>check_flips</span><span>(all_flips)
</span></code></pre><pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#6272a4># Calculate the probability to get at least one seven in a row
</span><span>prob </span><span style=color:#ff79c6>= </span><span style=color:#8be9fd>len</span><span>(np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>where</span><span>(seven_in_a_row </span><span style=color:#ff79c6>> </span><span style=color:#bd93f9>0</span><span>)[</span><span style=color:#bd93f9>0</span><span>]) </span><span style=color:#ff79c6>/ </span><span>nmc
</span><span style=color:#8be9fd>print</span><span>(</span><span style=color:#8be9fd;font-style:italic>f</span><span style=color:#f1fa8c>"Probability for at least one time seven in a row in </span><span>{nflips}</span><span style=color:#f1fa8c> flips is </span><span>{prob </span><span style=color:#ff79c6>* </span><span style=color:#bd93f9>100:.2f</span><span>}</span><span style=color:#f1fa8c>%."</span><span>)
</span></code></pre><pre style=color:#f8f8f2;background-color:#282a36><code><span>Probability for at least one time seven in a row in 100 flips is 17.13%.
</span></code></pre><pre class=language-python data-lang=python style=color:#f8f8f2;background-color:#282a36><code class=language-python data-lang=python><span style=color:#6272a4># Calculate the probability to get exactly one time seven in a row
</span><span>prob </span><span style=color:#ff79c6>= </span><span style=color:#8be9fd>len</span><span>(np</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>where</span><span>(seven_in_a_row </span><span style=color:#ff79c6>== </span><span style=color:#bd93f9>1</span><span>)[</span><span style=color:#bd93f9>0</span><span>]) </span><span style=color:#ff79c6>/ </span><span>nmc
</span><span style=color:#8be9fd>print</span><span>(</span><span style=color:#8be9fd;font-style:italic>f</span><span style=color:#f1fa8c>"Probability for one time seven in a row in </span><span>{nflips}</span><span style=color:#f1fa8c> flips is </span><span>{prob </span><span style=color:#ff79c6>* </span><span style=color:#bd93f9>100:.2f</span><span>}</span><span style=color:#f1fa8c>%."</span><span>)
</span></code></pre><pre style=color:#f8f8f2;background-color:#282a36><code><span>Probability for one time seven in a row in 100 flips is 15.77%.
</span></code></pre><h1 id=comparison-of-the-results><a aria-label="Anchor link for: comparison-of-the-results" class=zola-anchor href=#comparison-of-the-results>Comparison of the results</a></h1><p>As you can see, we get the same result from the Monte Carlo calculation as we got from the analytical calculation. If you are interested in why we used <code>@njit</code> before the <code>check_flips</code> function, please have a look at the docstring in that function and check out <a href=https://numba.pydata.org/><code>numba</code></a>. Without this decorator, we would wait a lot longer to simulate 10 million times one hundred flips. Numba was also used in this blog post <a href=https://galactic-forensics.space/resources/mind-bytes/suncrash/>here</a>, where more details are given.<p>Also, feel free to play with this example! Some questions you might ask:<ul><li>How many streaks of at least seven in a row are in the set?<li>How many streaks <em>insert you number here</em> are in the set?<li>How well has the result converged after ten million tries?</ul><p><a href="https://mybinder.org/v2/gh/galactic-forensics/mindbytes/HEAD?labpath=radiolab_stochasticity%2Fradiolab_stochasticity.ipynb"><img alt=Binder src=https://mybinder.org/badge_logo.svg></a></section></article></main></div>